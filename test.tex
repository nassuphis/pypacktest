\documentclass{article}
\usepackage{pythontex}
\usepackage[top=1in, bottom=1in, left=1cm, right=1cm]{geometry}
\usepackage{booktabs}  % Enables \toprule, \midrule, \bottomrule
\setlength{\parindent}{0pt}  % Removes paragraph indentation globally

\title{Straddle Activity Report} 
\author{Nick Nassuphis}    
\date{\today}  

\begin{pycode}
import straddle_activity as straddle
straddle.ltx=True
straddle.result_set = "result_nick_20250115_prod_0024"
def activity(ul,month):
    res=straddle.activity(ul,month)
    count = res["activity"].value_counts()
    lres = res.to_latex(formatters={
        'Underlying': lambda x: f'\\texttt{{{x}}}',
        'month': lambda x: f'\\texttt{{{x}}}',
        'date': lambda x: x.strftime('%Y-%m-%d'),
        'activity': lambda x: f'\\texttt{{{x}}}',
        'straddle': lambda x: f'\\texttt{{{x}}}'
    })
    print("\\noindent")
    print(lres)
    print("\n")
    print("\\vskip 1mm")
    print("\n")
    print(f"entries: {count.get('entry',0)},")
    print(f"expiries: {count.get('expiry',0)}\n")
    print("\\vskip 5mm")
\end{pycode}

\begin{document}

\maketitle  % Generates the title section
\newpage
\tableofcontents  % Generates the table of contents
\newpage

\section{\texttt{GBPUSD}}

\begin{pycode}
activity("GBPUSD Curncy","2025-01")
\end{pycode}

\begin{pycode}
activity("GBPUSD Curncy","2024-12")
\end{pycode}

\begin{pycode}
activity("GBPUSD Curncy","2024-11")
\end{pycode}

\newpage
\section{\texttt{EURUSD}}

\begin{pycode}
activity("EURUSD Curncy","2025-01")
\end{pycode}

\begin{pycode}
activity("EURUSD Curncy","2024-12")
\end{pycode}

\begin{pycode}
activity("EURUSD Curncy","2024-11")
\end{pycode}

\newpage
\section{\texttt{AUDUSD}}

\begin{pycode}
activity("AUDUSD Curncy","2025-01")
\end{pycode}

\begin{pycode}
activity("AUDUSD Curncy","2024-12")
\end{pycode}

\begin{pycode}
activity("AUDUSD Curncy","2024-11")
\end{pycode}

\newpage
\section{\texttt{SX5E Index}}

\begin{pycode}
activity("SX5E Index","2025-01")
\end{pycode}

\begin{pycode}
activity("SX5E Index","2024-12")
\end{pycode}

\begin{pycode}
activity("SX5E Index","2024-11")
\end{pycode}

\newpage
\section{\texttt{SPY US Equity}}

\begin{pycode}
activity("SPY US Equity","2025-01")
\end{pycode}

\begin{pycode}
activity("SPY US Equity","2024-12")
\end{pycode}

\begin{pycode}
activity("SPY US Equity","2024-11")
\end{pycode}

\end{document}

